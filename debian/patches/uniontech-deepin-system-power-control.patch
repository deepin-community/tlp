Index: tlp/deepin-system-power-control/00-deepin-system-power-control_performance.conf
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ tlp/deepin-system-power-control/00-deepin-system-power-control_performance.conf	2024-11-22 14:06:08.563687943 +0800
@@ -0,0 +1,54 @@
+# /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_performance.conf - deepin-system-power-control
+# IMPORTANT: do not edit this file, put your settings in /etc/tlp.conf or
+#            /etc/tlp.d/*.conf instead!
+# Copyright (c) 2023 DEEPIN.
+# SPDX-License-Identifier: GPL-2.0-or-later
+TLP_ENABLE=1
+TLP_WARN_LEVEL=3
+TLP_PERSISTENT_DEFAULT=0
+DISK_IDLE_SECS_ON_AC=0
+DISK_IDLE_SECS_ON_BAT=0
+MAX_LOST_WORK_SECS_ON_AC=15
+MAX_LOST_WORK_SECS_ON_BAT=15
+CPU_ENERGY_PERF_POLICY_ON_AC=performance
+CPU_ENERGY_PERF_POLICY_ON_BAT=performance
+NMI_WATCHDOG=0
+DISK_DEVICES="nvme0n1 sda"
+DISK_APM_LEVEL_ON_AC="254 254"
+DISK_APM_LEVEL_ON_BAT="254 254"
+DISK_APM_CLASS_DENYLIST="usb ieee1394"
+DISK_IOSCHED="keep keep"
+SATA_LINKPWR_ON_AC="med_power_with_dipm"
+SATA_LINKPWR_ON_BAT="med_power_with_dipm"
+AHCI_RUNTIME_PM_ON_AC=on
+AHCI_RUNTIME_PM_ON_BAT=on
+AHCI_RUNTIME_PM_TIMEOUT=15
+PCIE_ASPM_ON_AC=default
+PCIE_ASPM_ON_BAT=default
+RADEON_DPM_PERF_LEVEL_ON_AC=auto
+RADEON_DPM_PERF_LEVEL_ON_BAT=auto
+RADEON_POWER_PROFILE_ON_AC=default
+RADEON_POWER_PROFILE_ON_BAT=default
+WIFI_PWR_ON_AC=off
+WIFI_PWR_ON_BAT=off
+WOL_DISABLE=Y
+SOUND_POWER_SAVE_ON_AC=1
+SOUND_POWER_SAVE_ON_BAT=1
+SOUND_POWER_SAVE_CONTROLLER=Y
+BAY_POWEROFF_ON_AC=0
+BAY_POWEROFF_ON_BAT=0
+BAY_DEVICE="sr0"
+RUNTIME_PM_ON_AC=on
+RUNTIME_PM_ON_BAT=on
+RUNTIME_PM_DRIVER_DENYLIST="mei_me nouveau radeon"
+USB_AUTOSUSPEND=1
+USB_EXCLUDE_AUDIO=1
+USB_EXCLUDE_BTUSB=0
+USB_EXCLUDE_PHONE=0
+USB_EXCLUDE_PRINTER=1
+USB_EXCLUDE_WWAN=0
+RESTORE_DEVICE_STATE_ON_STARTUP=0
+RESTORE_THRESHOLDS_ON_BAT=0
+NATACPI_ENABLE=1
+TPACPI_ENABLE=1
+TPSMAPI_ENABLE=1
Index: tlp/deepin-system-power-control/00-deepin-system-power-control_saving.conf
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ tlp/deepin-system-power-control/00-deepin-system-power-control_saving.conf	2024-11-22 14:06:08.563687943 +0800
@@ -0,0 +1,55 @@
+# /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_saving.conf - deepin-system-power-control
+# IMPORTANT: do not edit this file, put your settings in /etc/tlp.conf or
+#            /etc/tlp.d/*.conf instead!
+# Copyright (c) 2023 DEEPIN.
+# SPDX-License-Identifier: GPL-2.0-or-later
+TLP_ENABLE=1
+TLP_WARN_LEVEL=3
+TLP_PERSISTENT_DEFAULT=0
+DISK_IDLE_SECS_ON_AC=2
+DISK_IDLE_SECS_ON_BAT=2
+MAX_LOST_WORK_SECS_ON_AC=60
+MAX_LOST_WORK_SECS_ON_BAT=60
+CPU_ENERGY_PERF_POLICY_ON_AC=balance_power
+CPU_ENERGY_PERF_POLICY_ON_BAT=balance_power
+NMI_WATCHDOG=0
+DISK_DEVICES="nvme0n1 sda"
+DISK_APM_LEVEL_ON_AC="128 128"
+DISK_APM_LEVEL_ON_BAT="128 128"
+DISK_APM_CLASS_DENYLIST="usb ieee1394"
+DISK_IOSCHED="keep keep"
+SATA_LINKPWR_ON_AC="med_power_with_dipm"
+SATA_LINKPWR_ON_BAT="med_power_with_dipm"
+AHCI_RUNTIME_PM_ON_AC=auto
+AHCI_RUNTIME_PM_ON_BAT=auto
+AHCI_RUNTIME_PM_TIMEOUT=15
+PCIE_ASPM_ON_AC=default
+PCIE_ASPM_ON_BAT=default
+RADEON_DPM_PERF_LEVEL_ON_AC=auto
+RADEON_DPM_PERF_LEVEL_ON_BAT=auto
+RADEON_POWER_PROFILE_ON_AC=default
+RADEON_POWER_PROFILE_ON_BAT=default
+WIFI_PWR_ON_AC=on
+WIFI_PWR_ON_BAT=on
+WOL_DISABLE=Y
+SOUND_POWER_SAVE_ON_AC=1
+SOUND_POWER_SAVE_ON_BAT=1
+SOUND_POWER_SAVE_CONTROLLER=Y
+BAY_POWEROFF_ON_AC=0
+BAY_POWEROFF_ON_BAT=0
+BAY_DEVICE="sr0"
+RUNTIME_PM_ON_AC=auto
+RUNTIME_PM_ON_BAT=auto
+RUNTIME_PM_DRIVER_DENYLIST="mei_me nouveau radeon"
+USB_AUTOSUSPEND=1
+USB_EXCLUDE_AUDIO=1
+USB_EXCLUDE_BTUSB=0
+USB_EXCLUDE_PHONE=0
+USB_EXCLUDE_PRINTER=1
+USB_EXCLUDE_WWAN=0
+RESTORE_DEVICE_STATE_ON_STARTUP=0
+RESTORE_THRESHOLDS_ON_BAT=0
+NATACPI_ENABLE=1
+TPACPI_ENABLE=1
+TPSMAPI_ENABLE=1
+
Index: tlp/tlp.service.in
===================================================================
--- tlp.orig/tlp.service.in	2024-11-22 14:06:08.563687943 +0800
+++ tlp/tlp.service.in	2024-11-22 14:06:08.563687943 +0800
@@ -15,6 +15,3 @@
 ExecStart=@TLP_SBIN@/tlp init start
 ExecReload=@TLP_SBIN@/tlp start
 ExecStop=@TLP_SBIN@/tlp init stop
-
-[Install]
-WantedBy=multi-user.target
Index: tlp/deepin-system-power-control/deepin-system-power-control
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ tlp/deepin-system-power-control/deepin-system-power-control	2024-11-22 14:06:08.563687943 +0800
@@ -0,0 +1,106 @@
+#!/bin/bash
+
+if [ "$(id -u)" != "0" ]; then
+    echo "Error:missing root privilege"
+    exit 1
+fi
+
+if [ "$1" != "set" ]; then
+    echo "The first parameter must be 'set'"
+    exit 1
+fi
+
+if [ "$2" != "performance" ] && [ "$2" != "saving" ] && [ "$2" != "balance" ] && [ "$2" != "lowbat" ]; then
+    echo "The second parameter must be 'performance' or 'saving'"
+    exit 1
+fi
+
+if [ "$2" == "performance" ]; then
+    if [ ! -f "/usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_performance.conf" ]; then
+        echo "File /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_performance.conf does not exist"
+        exit 1
+    fi
+
+    if ls /etc/tlp.d/00-deepin-system-power-control*.conf 1> /dev/null 2>&1; then
+        rm /etc/tlp.d/00-deepin-system-power-control*.conf
+    fi
+
+    cp /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_performance.conf /etc/tlp.d/
+    if [ $? -ne 0 ]; then
+        echo "Copy file failed"
+        exit 1
+    fi
+
+    tlp init start
+
+    if [ $? -ne 0 ];then
+        echo "tlp set failed"
+        exit $?
+    fi
+elif [ "$2" == "saving" ]; then
+    if [ ! -f "/usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_saving.conf" ]; then
+        echo "File /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_saving.conf does not exist"
+        exit 1
+    fi
+
+    if ls /etc/tlp.d/00-deepin-system-power-control*.conf 1> /dev/null 2>&1; then
+        rm /etc/tlp.d/00-deepin-system-power-control*.conf
+    fi
+
+    cp /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_saving.conf /etc/tlp.d/
+    if [ $? -ne 0 ]; then
+        echo "Copy file failed"
+        exit 1
+    fi
+
+    tlp init start
+
+    if [ $? -ne 0 ];then
+        echo "tlp set failed"
+        exit $?
+    fi
+elif [ "$2" == "balance" ]; then
+    if [ ! -f "/usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_balance.conf" ]; then
+        echo "File /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_balance.conf does not exist"
+        exit 1
+    fi
+
+    if ls /etc/tlp.d/00-deepin-system-power-control*.conf 1> /dev/null 2>&1; then
+        rm /etc/tlp.d/00-deepin-system-power-control*.conf
+    fi
+
+    cp /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_balance.conf /etc/tlp.d/
+    if [ $? -ne 0 ]; then
+        echo "Copy file failed"
+        exit 1
+    fi
+
+    tlp init start
+
+    if [ $? -ne 0 ];then
+        echo "tlp set failed"
+        exit $?
+    fi
+elif [ "$2" == "lowbat" ]; then
+    if [ ! -f "/usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_lowbat.conf" ]; then
+        echo "File /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_lowbat.conf does not exist"
+        exit 1
+    fi
+
+    if ls /etc/tlp.d/00-deepin-system-power-control*.conf 1> /dev/null 2>&1; then
+        rm /etc/tlp.d/00-deepin-system-power-control*.conf
+    fi
+
+    cp /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_lowbat.conf /etc/tlp.d/
+    if [ $? -ne 0 ]; then
+        echo "Copy file failed"
+        exit 1
+    fi
+
+    tlp init start
+
+    if [ $? -ne 0 ];then
+        echo "tlp set failed"
+        exit $?
+    fi
+fi
Index: tlp/deepin-system-power-control/00-deepin-system-power-control_balance.conf
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ tlp/deepin-system-power-control/00-deepin-system-power-control_balance.conf	2024-11-22 14:06:08.563687943 +0800
@@ -0,0 +1,54 @@
+# /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_performance.conf - deepin-system-power-control
+# IMPORTANT: do not edit this file, put your settings in /etc/tlp.conf or
+#            /etc/tlp.d/*.conf instead!
+# Copyright (c) 2023 DEEPIN.
+# SPDX-License-Identifier: GPL-2.0-or-later
+TLP_ENABLE=1
+TLP_WARN_LEVEL=3
+TLP_PERSISTENT_DEFAULT=0
+DISK_IDLE_SECS_ON_AC=0
+DISK_IDLE_SECS_ON_BAT=0
+MAX_LOST_WORK_SECS_ON_AC=15
+MAX_LOST_WORK_SECS_ON_BAT=15
+CPU_ENERGY_PERF_POLICY_ON_AC=balance_performance
+CPU_ENERGY_PERF_POLICY_ON_BAT=balance_performance
+NMI_WATCHDOG=0
+DISK_DEVICES="nvme0n1 sda"
+DISK_APM_LEVEL_ON_AC="254 254"
+DISK_APM_LEVEL_ON_BAT="254 254"
+DISK_APM_CLASS_DENYLIST="usb ieee1394"
+DISK_IOSCHED="keep keep"
+SATA_LINKPWR_ON_AC="med_power_with_dipm"
+SATA_LINKPWR_ON_BAT="med_power_with_dipm"
+AHCI_RUNTIME_PM_ON_AC=on
+AHCI_RUNTIME_PM_ON_BAT=on
+AHCI_RUNTIME_PM_TIMEOUT=15
+PCIE_ASPM_ON_AC=default
+PCIE_ASPM_ON_BAT=default
+RADEON_DPM_PERF_LEVEL_ON_AC=auto
+RADEON_DPM_PERF_LEVEL_ON_BAT=auto
+RADEON_POWER_PROFILE_ON_AC=default
+RADEON_POWER_PROFILE_ON_BAT=default
+WIFI_PWR_ON_AC=off
+WIFI_PWR_ON_BAT=off
+WOL_DISABLE=Y
+SOUND_POWER_SAVE_ON_AC=1
+SOUND_POWER_SAVE_ON_BAT=1
+SOUND_POWER_SAVE_CONTROLLER=Y
+BAY_POWEROFF_ON_AC=0
+BAY_POWEROFF_ON_BAT=0
+BAY_DEVICE="sr0"
+RUNTIME_PM_ON_AC=on
+RUNTIME_PM_ON_BAT=on
+RUNTIME_PM_DRIVER_DENYLIST="mei_me nouveau radeon"
+USB_AUTOSUSPEND=1
+USB_EXCLUDE_AUDIO=1
+USB_EXCLUDE_BTUSB=0
+USB_EXCLUDE_PHONE=0
+USB_EXCLUDE_PRINTER=1
+USB_EXCLUDE_WWAN=0
+RESTORE_DEVICE_STATE_ON_STARTUP=0
+RESTORE_THRESHOLDS_ON_BAT=0
+NATACPI_ENABLE=1
+TPACPI_ENABLE=1
+TPSMAPI_ENABLE=1
Index: tlp/deepin-system-power-control/00-deepin-system-power-control_lowbat.conf
===================================================================
--- /dev/null	1970-01-01 00:00:00.000000000 +0000
+++ tlp/deepin-system-power-control/00-deepin-system-power-control_lowbat.conf	2024-11-22 14:06:08.563687943 +0800
@@ -0,0 +1,55 @@
+# /usr/share/tlp/deepin-system-power-control/00-deepin-system-power-control_saving.conf - deepin-system-power-control
+# IMPORTANT: do not edit this file, put your settings in /etc/tlp.conf or
+#            /etc/tlp.d/*.conf instead!
+# Copyright (c) 2023 DEEPIN.
+# SPDX-License-Identifier: GPL-2.0-or-later
+TLP_ENABLE=1
+TLP_WARN_LEVEL=3
+TLP_PERSISTENT_DEFAULT=0
+DISK_IDLE_SECS_ON_AC=2
+DISK_IDLE_SECS_ON_BAT=2
+MAX_LOST_WORK_SECS_ON_AC=60
+MAX_LOST_WORK_SECS_ON_BAT=60
+CPU_ENERGY_PERF_POLICY_ON_AC=power
+CPU_ENERGY_PERF_POLICY_ON_BAT=power
+NMI_WATCHDOG=0
+DISK_DEVICES="nvme0n1 sda"
+DISK_APM_LEVEL_ON_AC="128 128"
+DISK_APM_LEVEL_ON_BAT="128 128"
+DISK_APM_CLASS_DENYLIST="usb ieee1394"
+DISK_IOSCHED="keep keep"
+SATA_LINKPWR_ON_AC="med_power_with_dipm"
+SATA_LINKPWR_ON_BAT="med_power_with_dipm"
+AHCI_RUNTIME_PM_ON_AC=auto
+AHCI_RUNTIME_PM_ON_BAT=auto
+AHCI_RUNTIME_PM_TIMEOUT=15
+PCIE_ASPM_ON_AC=default
+PCIE_ASPM_ON_BAT=default
+RADEON_DPM_PERF_LEVEL_ON_AC=auto
+RADEON_DPM_PERF_LEVEL_ON_BAT=auto
+RADEON_POWER_PROFILE_ON_AC=default
+RADEON_POWER_PROFILE_ON_BAT=default
+WIFI_PWR_ON_AC=on
+WIFI_PWR_ON_BAT=on
+WOL_DISABLE=Y
+SOUND_POWER_SAVE_ON_AC=1
+SOUND_POWER_SAVE_ON_BAT=1
+SOUND_POWER_SAVE_CONTROLLER=Y
+BAY_POWEROFF_ON_AC=0
+BAY_POWEROFF_ON_BAT=0
+BAY_DEVICE="sr0"
+RUNTIME_PM_ON_AC=auto
+RUNTIME_PM_ON_BAT=auto
+RUNTIME_PM_DRIVER_DENYLIST="mei_me nouveau radeon"
+USB_AUTOSUSPEND=1
+USB_EXCLUDE_AUDIO=1
+USB_EXCLUDE_BTUSB=0
+USB_EXCLUDE_PHONE=0
+USB_EXCLUDE_PRINTER=1
+USB_EXCLUDE_WWAN=0
+RESTORE_DEVICE_STATE_ON_STARTUP=0
+RESTORE_THRESHOLDS_ON_BAT=0
+NATACPI_ENABLE=1
+TPACPI_ENABLE=1
+TPSMAPI_ENABLE=1
+
Index: tlp/Makefile
===================================================================
--- tlp.orig/Makefile	2024-11-22 14:02:15.837416530 +0800
+++ tlp/Makefile	2024-11-22 14:27:23.000000000 +0800
@@ -28,6 +28,7 @@
 TLP_META    ?= /usr/share/metainfo
 TLP_RUN     ?= /run/tlp
 TLP_VAR     ?= /var/lib/tlp
+TLP_DEEPIN  ?= $(TLP_TLIB)/deepin-system-power-control
 
 # Catenate DESTDIR to paths
 _SBIN    = $(DESTDIR)$(TLP_SBIN)
@@ -54,6 +55,7 @@
 _META    = $(DESTDIR)$(TLP_META)
 _RUN     = $(DESTDIR)$(TLP_RUN)
 _VAR     = $(DESTDIR)$(TLP_VAR)
+_DEEPIN  = $(DESTDIR)$(TLP_DEEPIN)
 
 SED = sed \
 	-e "s|@TLPVER@|$(TLPVER)|g" \
@@ -143,6 +145,7 @@
 install-tlp: all
 	# Package tlp
 	install -D -m 755 tlp $(_SBIN)/tlp
+	install -D -m 755 deepin-system-power-control/deepin-system-power-control $(_SBIN)/deepin-system-power-control
 	install -D -m 755 tlp-rf $(_BIN)/bluetooth
 	ln -sf bluetooth $(_BIN)/nfc
 	ln -sf bluetooth $(_BIN)/wifi
@@ -156,6 +159,10 @@
 	install -m 755 tlp-pcilist $(_TLIB)/
 	install -m 755 tlp-readconfs $(_TLIB)/
 	install -m 755 tlp-usblist $(_TLIB)/
+	install -D -m 755 deepin-system-power-control/00-deepin-system-power-control_performance.conf $(_DEEPIN)/00-deepin-system-power-control_performance.conf
+	install -D -m 755 deepin-system-power-control/00-deepin-system-power-control_saving.conf $(_DEEPIN)/00-deepin-system-power-control_saving.conf
+	install -D -m 755 deepin-system-power-control/00-deepin-system-power-control_balance.conf $(_DEEPIN)/00-deepin-system-power-control_balance.conf
+	install -D -m 755 deepin-system-power-control/00-deepin-system-power-control_lowbat.conf $(_DEEPIN)/00-deepin-system-power-control_lowbat.conf
 	install -D -m 755 tlp-usb-udev $(_ULIB)/tlp-usb-udev
 	install -D -m 644 tlp.rules $(_ULIB)/rules.d/85-tlp.rules
 	[ -f $(_CONFUSR) ] || install -D -m 644 tlp.conf $(_CONFUSR)
